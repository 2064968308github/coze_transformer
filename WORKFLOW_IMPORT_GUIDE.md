# 工作流导入功能使用指南

## 功能概述

工作流导入功能允许用户将之前导出的工作流JSON文件重新导入到系统中，实现工作流的备份、迁移和分享。

## 使用方法

### 1. 在资源库中导入工作流

1. 进入工作空间的资源库页面 (`/space/{space_id}/library`)
2. 点击右上角的"+ 资源"按钮
3. 在下拉菜单中选择"导入工作流"选项
4. 在弹出的对话框中：
   - 点击"点击上传"按钮选择JSON文件
   - 系统会自动预览工作流信息（名称、描述、节点数、连线数）
   - 修改工作流名称（如需要）
   - 点击"导入"按钮完成导入

### 2. 在工作流模态框中导入

1. 在任何显示工作流选择的模态框中
2. 点击创建按钮的下拉箭头
3. 选择"导入工作流"选项
4. 按照相同的步骤完成导入

## 支持的文件格式

- **文件类型**: JSON格式 (`.json`)
- **文件大小**: 最大10MB
- **数据结构**: 必须包含 `name` 和 `schema` 字段的有效工作流导出数据

## 导入流程

1. **文件验证**: 检查文件格式、大小和数据结构
2. **数据解析**: 解析工作流JSON数据
3. **预览显示**: 显示工作流基本信息
4. **创建工作流**: 调用后端API创建新的工作流
5. **保存架构**: 保存工作流的节点和连线信息
6. **完成导入**: 显示成功消息并可选择跳转到新工作流

## API接口

### 后端接口

```
POST /api/workflow_api/import
```

**请求参数:**
```json
{
  "workflow_data": "工作流JSON数据字符串",
  "workflow_name": "工作流名称",
  "space_id": "工作空间ID", 
  "creator_id": "创建者ID",
  "import_format": "json"
}
```

**响应格式:**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "workflow_id": "新创建的工作流ID"
  }
}
```

## 测试用例

项目根目录下的 `test_workflow_import.json` 文件提供了一个测试用的工作流导出文件，可以用来测试导入功能。

## 错误处理

- **文件格式错误**: 提示选择有效的JSON文件
- **文件过大**: 提示文件大小限制
- **数据结构无效**: 提示选择有效的工作流导出文件
- **网络错误**: 显示导入失败消息
- **服务器错误**: 显示具体错误信息

## 注意事项

1. 导入的工作流会创建为新的工作流，不会覆盖现有工作流
2. 工作流名称可以在导入时修改
3. 导入后的工作流ID会发生变化
4. 导入功能支持所有类型的工作流（Workflow和ChatFlow）
5. 导入时会保留原始的节点和连线结构，但会生成新的ID

## 技术实现

### 前端组件
- `useImportWorkflowModal`: 导入模态框逻辑
- `useImportAction`: 导入操作处理
- `CreateWorkflowBtn`: 创建/导入按钮组件

### 后端服务
- `ImportWorkflow`: 导入业务逻辑
- `CreateWorkflow`: 创建工作流服务
- `SaveWorkflow`: 保存工作流架构